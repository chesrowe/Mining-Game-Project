<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-2</depth>
  <persistent>0</persistent>
  <parentName>obj_dupeParent</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///General
layer = 'surface';
dir = 0;
state = 'idle';
BloodColor = 'red';
gold = 1;
stone = 0;
goingTo = 0;
comingFrom = 0;
beingAttacked = 0;
animationSpeed = .3;
beingAttacked = 0;
attacker = 0;
knockBackTimer = 0;
knockBack = 0;
numberTimer = 0;
number = 0;
dying = 0;
selecting = 0;
selected = 0;
randomize();
moveToTime = 2 + irandom(15);
moveToTimer = 0;
target = -4;
targetType = 0;
moveTargetX = 0;
moveTargetY = 0;
moveXStart = 0;
myDraw = instance_create(x,y,obj_workerCon);
myDraw.myWorker = id;
image_speed = 0;
image_alpha = 1;
resourcePosition = 0; //1 = move left , 2 = move right
positionTimer = 0;
positionTime = 20;
idleTimer = 0;
insideSelectBox = 0;
insideSelectBoxAlt = 0;
middleTime = 0;
run = 0;
hillStart = 0;




//Stats
hp = 100;
maxStamina = 100;
stamina = maxStamina;
staminaRegen = 0;
staminaTimer = 0;
hpMax = 100;
level = 1;
woodcuttingLevel = 100;
miningLevel = 1;
farmingLevel = 1;
transportingLevel = 1;
xpOverall = 0;
xpNeededOverall = floor(level+300 * power(2,(level/7)));;
xpNeededWoodcutting = floor(woodcuttingLevel+300 * power(2,(woodcuttingLevel/7)));;
xpNeededMining = floor(miningLevel+300 * power(2,(miningLevel/7)));;
xpNeededFarming = floor(farmingLevel+300 * power(2,(farmingLevel/7)));;
xpWoodcutting = 0;
xpMining = 0;
xpFarming = 0;
hpBar = instance_create(x,y,obj_enemyHpDraw);
hpBar.myEnemy = id;
hpBar.hp = hp;
hpBar.hpMult = (hp/10);
walkSpeed = 1;
walkSpeedHill = .8;
leveled = 0;

//Dev mode
showDebug = 0; 

//Resources
goldHeld = 0;
maxGold = 40;

stoneHeld = 0;
maxStone = 40;

brimstoneHeld = 0;
maxBrimstone = 20;

crystalHeld = 0;
maxCrystal = 20;

mushroomHeld = 0;
maxMushroom = 20;

woodHeld = 0;
maxWood = 40;

foodHeld = 0;
maxFood = 50;

//Working general
workingLenDirX = lengthdir_x(40,point_direction(x,y,x,y));
workingLenDirY = lengthdir_y(26,point_direction(x,y,x,y));
walkingImageSpeed = .12;
drawTool = 0;
drawToolTimer = 0;
toolOut = 0;
dropOffTarget = obj_warehouse;
pickupLoad = 100;
supplyDropOff = 0;
dropOffTimer = 0;
dropX = 0;
dropY = 0;
workStart = 0;
workTimer = 0;
workMiddleTime = 0;
baseWorkTime = 300;
workTimeAdd = irandom(round(baseWorkTime/3));
workTime = (baseWorkTime + workTimeAdd);

//Building
buildingImageSpeed = .11;
baseBuildingTime = 200;
gettingResources = 0;
currentResource = -1;

//mining
baseMiningTime = 400;
mineTimeAdd = irandom(round(baseMiningTime/3));
miningTime = (baseMiningTime + mineTimeAdd);
miningTimer = 0;
mineStart = 0;
waitingToMine = 0;
mineAmount = 40;
miningLevel = 1;
randomize();
middleTimeMining = (2 + irandom(15));
miningImageSpeed = .11;
drawToolTimeMining = 45;
gemBonus = 0//(((1000) * .01) * miningLevel);



//woodcutting
baseCuttingTime = 500;
cuttingTime = 500;
falling = 0;
cuttingTimer = 0;
cutStart = 0;
move = 0;
moveTimer = 0;
cutSound = 0;
randomize();
cutTimeAdd = irandom(round(baseCuttingTime/3));
middleTimeWoodcutting =  (2 + irandom(10));
woodcuttingImageSpeed = .11;
drawToolTimeWoodcutting = 45;


//Farming
baseFarmingTime = 600;
farmingTime = 600;
farmTimeAdd = irandom(round(baseFarmingTime/3));
farmingTimer = 0;
farmStart = 0;
middleTimer = 0;
middleTimeFarming = (choose(34,40,50) + irandom(80));
drawToolTimeFarming = 45;
farmingImageSpeed = .10;
waitingToFarm = 0;

//variables
soundPosition = 0;
soundYDiff = 0;
soundXDiff = 0;

falling = 1;




</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Sound

//Variables
pickSoundTimer = 0;
footstepTimer = 0;
workRRPosition = 0;
footstepRRPosition = 0;
stepSound = 0;
footStepSound = -4;

//4 round robins for pick sounds
pickSound[0] = sd_pickaxe1; 
pickSound[1] = sd_pickaxe2;
pickSound[2] = sd_pickaxe3;
pickSound[3] = sd_pickaxe4;

//Footstep sounds

//4 RR for woodcutting
woodcutSound[0] = sd_woodcut1; 
woodcutSound[1] = sd_woodcut2; 
woodcutSound[2] = sd_woodcut3; 
woodcutSound[3] = sd_woodcut4; 

//4 RR for grass footsteps
footstepGrassSound[0] = sd_footstepGrass1; 
footstepGrassSound[1] = sd_footstepGrass2; 
footstepGrassSound[2] = sd_footstepGrass3; 
footstepGrassSound[3] = sd_footstepGrass4; 

//4 RR for ground footsteps
footstepGroundSound[0] = sd_footstepGround1; 
footstepGroundSound[1] = sd_footstepGround2; 
footstepGroundSound[2] = sd_footstepGround3; 
footstepGroundSound[3] = sd_footstepGround4; 

//4 RR for ground footsteps
footstepIceSound[0] = sd_footstepIce1; 
footstepIceSound[1] = sd_footstepIce2; 
footstepIceSound[2] = sd_footstepIce3; 
footstepIceSound[3] = sd_footstepIce4; 

//4 RR for farming
farmingSound[0] = sd_farming1; 
farmingSound[1] = sd_farming2; 
farmingSound[2] = sd_farming3; 
farmingSound[3] = sd_farming4; 

//4 RR for pulling out tool
pullOutToolSound[0] = sd_toolPullOut1; 
pullOutToolSound[1] = sd_toolPullOut2; 
pullOutToolSound[2] = sd_toolPullOut3; 
pullOutToolSound[3] = sd_toolPullOut4; 
 

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Sprites

//Putting sprite indexes into variables so that we can change the sprites on the go without changing the code that changes the sprites
idleImageSpeed = .09;

spriteIdle = spr_workerIdle;

spriteSittingDown = spr_workerSittingDown;

spriteWalking = spr_workerWalking;

spriteWalkingResources = spr_workerWalkingResources;

spriteRunning = spr_workerRunning;

spriteMining = spr_workerMining;

spriteMiningDrawTool = spr_workerMiningDrawTool;

spriteWoodcutting = spr_workerWoodcuting;

spriteWoodcuttingDrawTool = spr_workerWoodcutingDrawTool;

spriteFarming = spr_workerFarming;

spriteFarmingDrawTool = spr_workerFarmingDrawTool;

spriteBuilding = spr_workerBuilding;

spriteBuildingDrawTool = spr_workerBuildingDrawTool;

spritePickUp = spr_workerPickup;

spriteDropResources = spr_workerDropResources; 

spriteDamageFrame = spr_workerDamageFrame;

spriteDying = spr_workerDying;




sprite_index = spriteIdle;
image_speed = idleImageSpeed;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Inventory Setup

//inv[?,0] = name
//inv[?,1] = type
//inv[?,2] = gem socket
//inv[?,3] = gem bonus 1 
//inv[?,4] = gem bonus 2 
//inv[?,5] = gem bonus 3 
//inv[?,6] = amount 
//First three slots are the tool slots pickaxe - hatchet - hoe
//slot 1
inv[0,0] = "Iron Pickaxe";
inv[0,1] = "tool";
inv[0,2] = -1;
inv[0,3] = -1;
inv[0,4] = -1;
inv[0,5] = -1;
//slot 2
inv[1,0] = "Iron Hatchet";
inv[1,1] = "tool";
inv[1,2] = -1;
inv[1,3] = -1;
inv[1,4] = -1;
inv[1,5] = -1;
//slot 3
inv[2,0] = "Iron Hoe";
inv[2,1] = "tool";
inv[2,2] = -1;
inv[2,3] = -1;
inv[2,4] = -1;
inv[2,5] = -1;
//slot 4
inv[3,0] = -1;
inv[3,1] = -1;
inv[3,2] = -1;
inv[3,3] = -1;
inv[3,4] = -1;
inv[3,5] = -1;
inv[3,6] = -1;
//slot 5
inv[4,0] = -1;
inv[4,1] = -1;
inv[4,2] = -1;
inv[4,3] = -1;
inv[4,4] = -1;
inv[4,5] = -1;
inv[4,6] = -1;
//slot 6
inv[5,0] = -1;
inv[5,1] = -1;
inv[5,2] = -1;
inv[5,3] = -1;
inv[5,4] = -1;
inv[5,5] = -1;
inv[5,6] = -1;
//slot 7
inv[6,0] = -1;
inv[6,1] = -1;
inv[6,2] = -1;
inv[6,3] = -1;
inv[6,4] = -1;
inv[6,5] = -1;
inv[6,6] = -1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Falling 
// y = y + lengthdir_y(2,70); 
//x = x + lengthdir_x(2,70); 

if (falling){
    if (place_meeting(x,y+3,obj_groundParent)){
        falling = 0;
        if (place_meeting(x,y+3,obj_tileSurfaceFlatParent) &amp;&amp; !place_meeting(x,y,obj_tileSurfaceHillParent)){
            y = (instance_place(x,y+3,obj_tileSurfaceFlatParent).y) - 24;
        }
    }else if (!hillStart){
        falling = 1;
    }
}else if (!place_meeting(x,y+3,obj_groundParent) &amp;&amp; !hillStart){
    falling = 1;
}

//when the worker is falling 
if (falling){
    gravity = 0.2;
}else{
    gravity = 0;
    vspeed = 0;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Move to target
if (state == 'moveToTarget' &amp;&amp; !global.workerBuild){
    moveToTimer ++;
    image_speed = walkingImageSpeed;
}
//move towards target 
if (moveToTimer &gt; moveToTime){
    if (run){
            staminaTimer = 0;
            sprite_index = spriteRunning; 
            if (stamina &gt; 0){
                stamina --;
            }else{
                run = 0;
            }
        }else{
            sprite_index = spriteWalking;
        }
        
    if ( (state == "moveToTarget" &amp;&amp; moveTargetX &gt;= x) &amp;&amp; (moveToTimer &gt; moveToTime)){
         image_xscale = 1;
         scr_unit_move_avoiding(walkSpeed,run,1);
    }else if (state == 'moveToTarget' &amp;&amp; moveTargetX &lt;= x){
        image_xscale = -1;
        scr_unit_move_avoiding(walkSpeed,run,0); 
    }
}else if (state == 'moveToTarget'){
    image_index = 0;
}

//Stop when the target is reached
if (state == 'moveToTarget' &amp;&amp; ceil(point_distance(x,y,moveTargetX,y)) &lt;= 1 &amp;&amp; moveToTimer &gt; moveToTime){
    state = 'idle';
    run = 0;
    moveToTimer = 0;
    image_speed = idleImageSpeed;
    sprite_index = spriteIdle;
    
    if (moveXStart == 'less'){
        image_xscale = 1;
    }else{
        image_xscale = -1;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///sound

//footsteps
if (state != "idle"){
    if (gettingResources || goingTo || comingFrom || state == 'moveToTarget'){
        if (round(image_index) == 1 &amp;&amp; stepSound == 0 || round(image_index) == 5 &amp;&amp; stepSound == 0){
            randomize();
            if (!audio_is_playing(footstepGrassSound[footstepRRPosition])){
                footStepSound = audio_play_sound_at(footstepGrassSound[footstepRRPosition],x,y,0,1000,200,1,0,1);  
            }
            audio_sound_pitch(footStepSound,random_range(.90,1.3));
            audio_sound_gain(footStepSound, global.sfxVol,0);
            footstepRRPosition ++;
            if (footstepRRPosition &gt; 3){
                footstepRRPosition = irandom(2);
            }       
            stepSound = 1;
        } 
        
        if (round(image_index) != 1 &amp;&amp; round(image_index) != 5){
            stepSound = 0;
        }
    }
    //Pulling out tool
    if (drawTool &amp;&amp; drawToolTimer == 0){
        var sound = audio_play_sound_at(pullOutToolSound[irandom(3)],x,y,0,1000,200,1,0,5);
        audio_sound_gain(sound,global.sfxVol,0);
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Farming
if (!dying){
    
    if (state == 'farming'){
        moveToTimer ++;
        image_speed = walkingImageSpeed;
        //Workers walks to the resource to farm it
        if (moveToTimer &gt; moveToTime){
            sprite_index = spriteWalking;
            if (target.x &gt; x &amp;&amp; !farmStart &amp;&amp; goingTo){
                image_xscale = 1;
                scr_unit_move_avoiding(walkSpeed,0,1);
            }else if(!farmStart &amp;&amp; goingTo){
                image_xscale = -1;
                scr_unit_move_avoiding(walkSpeed,0,0);
            }
        }
        //Starts the worker to mining
        if (farmStart){
            image_speed = farmingImageSpeed;
            if (!drawTool){
                farmingTimer ++;
                //set the sprite
                sprite_index = spriteFarming;
                if (x &gt; target.x){
                    image_xscale = -1;
                }else{
                    image_xscale = 1;
                } 
                //Triggers sound and particles
                if (round(image_index) == 5 &amp;&amp; cutSound == 0){
                    var sound = audio_play_sound_at(farmingSound[workRRPosition],x,y,0,1000,200,1,0,999999);  
                    audio_sound_gain(sound,global.sfxVol,0);
                    part_particles_create(global.partMining,x+workingLenDirX,y+workingLenDirY,global.partWoodChips,10);
                    workRRPosition ++;
                    if (workRRPosition &gt; 3){
                        randomize();
                        workRRPosition = irandom(2);
                    }
                    cutSound = 1; 
                } 
                if (round(image_index) != 5){
                    cutSound = 0;
                }
                //Makes miner take the resousces to the stockpile
                if (farmingTimer &gt;= farmingTime){
                    randomize();
                    goingTo = 0;
                    comingFrom = 1;
                    farmStart = 0;
                    farmingTimer = 0;
                    moveToTime = 2 + irandom(20);
                    moveToTimer = 0;
                    middleTimer = 0;
                    target.amountLeft -= 40;
                    //pops up xp gained
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        amount = ("+"+string((other.target).xp)+"XP");
                        col = c_yellow;
                        myWorker = other.id;
                    }
                    xpFarming += target.xp;
                    //Put the just mined resources into the inventory
                    for (i = 3;i &lt;= 6; i++){
                        if (is_real(inv[i,0]) &amp;&amp; inv[i,0] == -1){
                            inv[i,0] = target.resource;
                            inv[i,1] = 'resource';
                            inv[i,6] = pickupLoad;
                            break;
                        }
                    }
                    //levels up if there is enough xp
                    if (xpFarming &gt;= xpNeededFarming){
                        farmingLevel ++;
                        xpNeededFarming += floor(farmingLevel+300 * power(2,(farmingLevel/7)));
                        baseFarmingTime -= (10 + irandom(5));
                    }
                    
                }
            }else{
            //starts the pulling out tool animation
                sprite_index = spriteFarmingDrawTool;
                if (target.x &gt; x){
                    image_xscale = 1;
                }else{
                    image_xscale = -1;  
                }
                    drawToolTimer ++;
                if (drawToolTimer &gt;= drawToolTimeWoodcutting){
                    drawTool = 0;
                    drawToolTimer = 0;
                    dir = point_direction(x,y,target.x,target.y);
                }
            }
        }
        //Wait for resource to not be exhausted
        with(target){
            if (amountLeft &lt;= 0){
                if (!exPopUp){
                    moveToTimer = 0;
                    exPopUp = 1;
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        col = c_red;
                        amount = "!";
                        xScale = 2;
                        yScale = 2;
                    }
                }
                amountLeft = 0;
                exhausted = 1;
                other.farmStart = 0;
                other.farmingTimer = 0;
                other.pickSoundTimer = 0;
            }
        }
        //Starts the worker back to farming
        if (waitingToFarm &amp;&amp; target.exhausted == 0){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                farmStart = 1;
                farmingTimer = 0;
                pickSoundTimer = 0;
                comingFrom = 0;
                drawTool = 0;
                gointTo = 1;
                waitingToFarm = 0;
                
                sprite_index = spriteFarming;
                if (target.x &gt; x){
                    image_xscale = 1;
                }else{
                    image_xscale = -1;
                }
            }
        //set idle animation
        }else if (waitingToFarm){
            sprite_index = spriteIdle;
            image_speed = idleImageSpeed;
            if (target.x &gt; x){
                image_xscale = 1;
            }else{
                image_xscale = -1;
            }   
        }
        //Sets the miner going towards the stockpile
        if (comingFrom &amp;&amp; x &lt; dropOffTarget.x){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                image_xscale = 1;
                scr_unit_move_avoiding(walkSpeed,0,1);   
            }
        }else if (comingFrom){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                image_xscale = -1;
                scr_unit_move_avoiding(walkSpeed,0,0);
            }
        }
    
    }    

}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Mining
if (!dying){
    
    if (state == 'mining'){
        moveToTimer ++;
        image_speed = walkingImageSpeed;
        //Workers walks to the resource to mine it
        if (moveToTimer &gt; moveToTime){
            sprite_index = spriteWalking;
            if (target.x &gt; x &amp;&amp; !mineStart &amp;&amp; goingTo){
                image_xscale = 1;
                scr_unit_move_avoiding(walkSpeed,0,1); 
            }else if(!mineStart &amp;&amp; goingTo){
                image_xscale = -1;
                scr_unit_move_avoiding(walkSpeed,0,0);  
            }
        }
        //Starts the worker to mining
        if (mineStart){
            image_speed = miningImageSpeed;
            if (!drawTool){
                miningTimer ++;
                //set the sprite
                sprite_index = spriteMining;
                if (x &gt; target.x){
                    image_xscale = -1;
                }else{
                    image_xscale = 1;
                } 
                //Triggers sound and particles
                if (round(image_index) == 5 &amp;&amp; cutSound == 0){
                    var dir = point_direction(x,y,target.x,target.y);
                    var sound = audio_play_sound_at(pickSound[workRRPosition],x,y,0,1000,200,1,0,999999);  
                    audio_sound_gain(sound,global.sfxVol,0);
                    part_particles_create(global.partMining,x+lengthdir_x(6,dir),y+lengthdir_y(6,dir),global.partStoneChips,10);
                    workRRPosition ++;
                    if (workRRPosition &gt; 3){
        
                        workRRPosition = irandom(2);
                    }
                    cutSound = 1; 
                } 
                if (round(image_index) != 5){
                    cutSound = 0;
                }
                //Makes miner take the resources to the stockpile
                if (miningTimer &gt;= miningTime){
                    goingTo = 0;
                    comingFrom = 1;
                    mineStart = 0;
                    miningTimer = 0;
                    moveToTime = 2 + irandom(20);
                    moveToTimer = 0;
                    middleTimer = 0;
                    target.amountLeft -= 40;
                    //pops up xp gained
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        amount = ("+"+string((other.target).xp)+"XP");
                        col = c_yellow;
                        myWorker = other.id;
                    }
                    xpMining += target.xp;
                    //Put the just mined resources into the inventory
                    for (i = 3;i &lt;= 6; i++){
                        if (is_real(inv[i,0]) &amp;&amp; inv[i,0] == -1){
                            inv[i,0] = target.resource;
                            inv[i,1] = 'resource';
                            inv[i,6] = pickupLoad;
                            break;
                        }
                    }
    
                    if (xpMining &gt;= xpNeededMining){
                        miningLevel ++;
                        xpNeededMining += floor(miningLevel+300 * power(2,(miningLevel/7)));
                        baseMiningTime -= (10 + irandom(5));
                    }
                    
                }
            }else{
            //starts the pulling out tool animation
                sprite_index = spriteMiningDrawTool;
                if (target.x &gt; x){
                    image_xscale = 1;
                }else{
                    image_xscale = -1; 
                }
                    drawToolTimer ++;
                if (drawToolTimer &gt;= drawToolTimeWoodcutting){
                    drawTool = 0;
                    drawToolTimer = 0;
                    dir = point_direction(x,y,target.x,target.y);
                }
            }
        }
        //Wait for resource to not be exhausted
        with(target){
            if (amountLeft &lt;= 0){
                if (!exPopUp){
                    moveToTimer = 0;
                    moveToTime = 2 + irandom(20);
                    exPopUp = 1;
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        col = c_red;
                        amount = "!";
                        xScale = 2;
                        yScale = 2;
                    }
                }
                amountLeft = 0;
                exhausted = 1;
                other.mineStart = 0;
                other.miningTimer = 0;
                other.pickSoundTimer = 0;
            }
        }
        //Starts the worker back to mining
        if (waitingToMine &amp;&amp; target.exhausted == 0){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                mineStart = 1;
                miningTimer = 0;
                goingTo = 1;
                pickSoundTimer = 0;
                comingFrom = 0;
                goingTo = 0;
                waitingToMine = 0;
                drawTool = 1;
                sprite_index = spriteMining;
                if (target.x &gt; x){
                    image_xscale = 1;
                }else{
                    image_xscale = -1;
                }
            }
        //set idle animation
        }else if (waitingToMine){
                sprite_index = spriteIdle;
                image_speed = idleImageSpeed;
            if (target.x &gt; x){
                image_xscale = 1;
            }else{
                image_xscale = -1;
            }   
        }
        //Sets the miner going towards the stockpile
        if (comingFrom &amp;&amp; x &lt; dropOffTarget.x){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                image_xscale = 1;
                scr_unit_move_avoiding(walkSpeed,0,1);     
        }
        }else if (comingFrom){
            moveToTimer ++;
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                image_xscale = -1;
                scr_unit_move_avoiding(walkSpeed,0,0);  
            }
        }
    }  
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Fighting

if (!dying){
  //When the miner is being attacked
    if (beingAttacked){
        miningTimer = 0;
        mineStart = 0;
        if (knockBack){
            knockBackTimer ++;
            if (knockBackTimer &lt; 20){
                if (attacker.x &gt; x){
                    x -= .8;
                }else{
                    x += .8;
                }
            }else{
                knockBack = 0;
                knockBackTimer = 0;
            }
        }    
    }else{
        knockBackTimer = 0;
        knockBack = 0;
    }
        
    if (numberTimer &gt;= 1){
        numberTimer ++;
        if (numberTimer &gt;= 10){
            dmgNumber = instance_create(x,y-10,obj_enemyDrawCon);
            dmgNumber.myEnemy = id;
            dmgNumber.dmg = attacker.dmg;
            numberTimer = 0;
            hp -= attacker.dmg;
            part_particles_create(global.partEnemyBlood,x,y,global.partBloodRed,20);
        }
    }
}else{
    image_speed = 0;
    image_alpha -= .01;
    if (image_alpha &lt;= 0){
        instance_destroy();
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Woodcutting
if (state == 'woodcutting'){
    image_speed = walkingImageSpeed;
    moveToTimer ++;
     //makes the worker walk to the tree
     if (moveToTimer &gt; moveToTime){
         sprite_index = spriteWalking;
         if (instance_exists(target)&amp;&amp; target.x &gt; x &amp;&amp; !cutStart &amp;&amp; goingTo){
            image_xscale = 1;
            scr_unit_move_avoiding(walkSpeed,0,1);
         }else if(!cutStart &amp;&amp; goingTo){
            image_xscale = -1;
            scr_unit_move_avoiding(walkSpeed,0,0);
         }
     }
    //starts the worker to woodcutting
    if (cutStart){
        image_speed = woodcuttingImageSpeed;
        if (!drawTool){
            cuttingTimer ++;
            //set the sprite
            if (instance_exists(target)){
                sprite_index = spriteWoodcutting;
                if (x &gt; target.x){
                    image_xscale = -1;
                }else{
                    image_xscale = 1;
                }
            }
            //Triggers sound and particles
            if (round(image_index) == 6 &amp;&amp; cutSound == 0){
                if (instance_exists(target)){
                    dir = point_direction(x,y,target.x,target.y);
                    part_particles_create(global.partMining,x+lengthdir_x(32,dir),y,global.partWoodChips,10);
                }
                workSound = audio_play_sound_at(woodcutSound[workRRPosition],x,y,0,1000,200,1,0,workRRPosition); 
                randomize();
                audio_sound_gain(workSound,global.sfxVol,0);
                audio_sound_pitch(workSound,random_range(.95,1.2)); 
                workRRPosition ++;
                if (workRRPosition &gt; 3){
                    randomize();
                    workRRPosition = irandom(2);
                }
                cutSound = 1; 
            } 
            if (round(image_index) != 6){
                cutSound = 0;
            }
            //adds the resouces the worker and decements wood from the tree
            if (instance_exists(target)){
                if (cuttingTimer &gt;= cuttingTime &amp;&amp; !target.falling){
                    image_speed = walkingImageSpeed;
                    goingTo = 0;
                    drawTool = 0;
                    comingFrom = 1;
                    middleTimer = 0;
                    cutStart = 0;
                    cuttingTimer = 0;
                    target.woodLeft -= 100;
                    target.fall -= 100;
                    //Randomizes the position of the cutting more when then the target tree has fallen
                    if (instance_exists(target)){
                        if (target.fell == 0){
                            middleTimeWoodcutting =  (2 + irandom(target.midRandom));
                        }else{
                            middleTimeWoodcutting =  (2 + irandom(target.midRandom) + irandom(40));    
                        }
                    }
                    moveToTime = 2 + irandom(20);
                    moveToTimer = 0;
                    //pops up xp gained
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        amount = ("+"+string((other.target).xp)+"XP");
                        col = c_yellow;
                        myWorker = other.id;
                    }
                    //If the worker is already over the warehouse stop the middletimer 
                    if (place_meeting(x,y,obj_warehouse)){
                        middleTimer = middleTimeWoodcutting;
                    }
                    //pops up xp gained
                    xpWoodcutting += target.xp;
                    //Put the just mined resources into the inventory
                    for (i = 3;i &lt;= 6; i++){
                        if (is_real(inv[i,0]) &amp;&amp; inv[i,0] == -1){
                            inv[i,0] = target.resource;
                            inv[i,1] = 'resource';
                            inv[i,6] = pickupLoad;
                            break;
                        }
                    }
                    //Levels the worker up if he has enough XP
                    if (xpWoodcutting &gt;= xpNeededWoodcutting){
                        with(instance_create(x,y,obj_workerDrawTimed)){
                            myWorker = other.id;
                            amount = "Level Up!";
                            col = c_yellow;
                        }
                        woodcuttingLevel ++;
                        xpNeededWoodcutting += floor(woodcuttingLevel+300 * power(2,(woodcuttingLevel/7)));
                        baseCuttingTime -= (10 + irandom(5));
                    }
                    //if warehouse is not built, make idle
                    if (!instance_exists(dropOffTarget)){
                        state = 'idle';
                    }
                    //check to see if the tree is over the warehouse
                    if (point_distance(x,y,dropOffTarget.x,dropOffTarget.y) &lt; 10){
                        middleTimer = 50;
                    }
                }
            //If the tree is destroyed before the cutting timer ends. (fail safe)
            }else if (cuttingTimer &gt; cuttingTime){
                cutStart = 0;
                comingFrom = 1;
                goingTo = 0;
            }
        }else{
            //starts the pulling out tool animation
            if (instance_exists(target)){
                sprite_index = spriteWoodcuttingDrawTool;
                if (target.x &gt;= x){
                    image_xscale = 1;
                }else{
                    image_xscale = -1;   
                }
            }
            drawToolTimer ++;
            if (instance_exists(target)){
                if (drawToolTimer &gt;= drawToolTimeFarming){
                    drawTool = 0;
                    drawToolTimer = 0;
                    dir = point_direction(x,y,target.x,target.y);
                }
            }
        }
    }
    //Makes the worker take the reources to the stockpile
    
    if (comingFrom &amp;&amp; x &lt; dropOffTarget.x &amp;&amp; instance_exists(dropOffTarget)){
        moveToTimer ++;
        if (moveToTimer &gt; moveToTime){
            sprite_index = spriteWalkingResources;
            image_xscale = 1;
            scr_unit_move_avoiding(walkSpeed,0,1);    
        }
    }else if (comingFrom){
        moveToTimer ++;
        if (moveToTimer &gt; moveToTime){
            sprite_index = spriteWalkingResources;
            image_xscale = -1;
            scr_unit_move_avoiding(walkSpeed,0,0);
        }
    }
  
    //If the target tree gets destroyed , set the state to idle
    if ( (goingTo || (goingTo &amp;&amp; comingFrom == 0) ) &amp;&amp; !instance_exists(target) &amp;&amp; distance_to_object(instance_nearest(x,y,obj_treeParent)) &gt; 3000){
        state = 'idle';
        goingTo = 0;
        comingFrom = 0;
        middleTimer = 0;  
        cutStart = 0;
        cuttingTimer = 0;
        moveTimer = 0;
        moveToTimer = 0;  
        drawToolTimer = 0;
        sprite_index = spriteIdle;
    }else if ( !comingFrom &amp;&amp; distance_to_object(instance_nearest(x,y,obj_treeParent)) &lt; 3000 &amp;&amp; !instance_exists(target)){
        target = instance_nearest(x,y,obj_treeParent);
        state = 'woodcutting';
        comingFrom = 0;
        cuttingTimer = 0;
        moveToTimer = 0;
        cutStart = 0;
        middleTimer = 0;
        drawToolTimer = 0;
        goingTo = 1;        
    }
}






</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///select box



if (global.select &amp;&amp; selected == 0){
    insideSelectBox = point_in_rectangle(x,y,global.selectStartX,global.selectStartY,mouse_x,mouse_y);
    insideSelectBoxAlt = point_in_rectangle(x,y,mouse_x,mouse_y,global.selectStartX,global.selectStartY);
    var insideSelectBoxAlt2 = point_in_rectangle(x, y, mouse_x, global.selectStartY, mouse_x + (global.selectStartX - mouse_x), mouse_y);
    var insideSelectBoxAlt3 = point_in_rectangle(x, y, mouse_x + (global.selectStartX - mouse_x), mouse_y, mouse_x, global.selectStartY);
    if (insideSelectBox || insideSelectBoxAlt || insideSelectBoxAlt2 || insideSelectBoxAlt3){
        global.selectedNumber ++;
        global.unitSelected[global.selectedNumber - 1] = id;
        selected = 1;
    }
}

if (global.select &amp;&amp; selected == 1){
    if (!insideSelectBox &amp;&amp; !insideSelectBoxAlt &amp;&amp; !insideSelectBoxAlt2 &amp;&amp; !insideSelectBoxAlt3){
        selected = 0;
    }    
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Working general

if (comingFrom &amp;&amp; !instance_exists(dropOffTarget)){
    state = 'idle';
    sprite_index = spriteIdle;
    if (target.x &gt; x){
        image_xscale = 1;
    }else{
        image_xscale = -1;
    }
}
//Moves the worker in position to work, if he is directly on top of the resource
//1 = left, 2 = right
if (resourcePosition == 1){
    positionTimer ++;
    scr_unit_move_avoiding(walkSpeed,0,0);            
}else if (resourcePosition == 2){
    positionTimer ++;
    scr_unit_move_avoiding(walkSpeed,0,1);
}
// stop the movement
if (positionTimer &gt;= positionTime &amp;&amp; (resourcePosition == 1 || resourcePosition == 2)){
    positionTimer = 0;
    goingTo = 1;
    resourcePosition = 0;    
    middleTimer = 0;
    if (x &gt; target.x){
        
    }
}
//Make the worker take their resources back to the warehouse before they begin working
if (goingTo &amp;&amp; state != 'building'){
    if (is_real(inv[3,0]) &amp;&amp; inv[3,0] != -1){
        goingTo = 0;
        comingFrom = 1;
    }    
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Multi-click select

//State select
if (global.workerStateSelect == 1 &amp;&amp; state == global.workerSelectState &amp;&amp; (distance_to_point((view_wview[0]/2), y &lt; 2000)) &amp;&amp; selected == 0){
    global.selectedNumber ++;
    global.unitSelected[global.selectedNumber - 1] = id;
    selected = 1;
}

//select all
if (global.workerSelectAll &amp;&amp; distance_to_point((view_wview[0]/2),y) &lt;= 2000 &amp;&amp; selected == 0){
    global.selectedNumber ++;
    global.unitSelected[global.selectedNumber - 1] = id;
    selected = 1;                
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Idle/Sitting

//Make the worker sit down after they have stayed idle for while
if (state == 'idle'){
    sprite_index = spriteIdle;
    idleTimer ++;
    if (idleTimer &gt;= 600){
        state = 'sitting';   
        image_index = 0;
        idleTimer = 0;     
    }   

}

//Sitting

if (state == 'sitting'){
    image_speed = .10
    idleTimer = 0;
    sprite_index = spriteSittingDown;
    
    //Make sure the animation stops on the sitting frame    
    if (image_index &gt;= 5){
        image_speed = 0;
        image_index = 5;
    }
}











</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Building 

if (!dying){
    
    if (state == 'building'){
        if (!gettingResources){
            moveToTimer ++;
            image_speed = walkingImageSpeed;
            //Workers walks to the building to bulid it
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                if (target.x &gt; x &amp;&amp; !workStart &amp;&amp; goingTo){
                    image_xscale = 1;    
                    scr_unit_move_avoiding(walkSpeed,0,1);  
                }else if(!workStart &amp;&amp; goingTo){
                    image_xscale = -1;
                    scr_unit_move_avoiding(walkSpeed,0,0); 
                }
            }
        }else{
            moveToTimer ++;
            image_speed = walkingImageSpeed;
            //Worker goes to get resources from the stockpile to build the building with
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalking;
                if (obj_warehouse.x &gt; x &amp;&amp; !workStart &amp;&amp; gettingResources){
                    image_xscale = 1;
                    scr_unit_move_avoiding(walkSpeed,0,1);  
                }else if(!workStart &amp;&amp; gettingResources){
                    image_xscale = -1;
                    scr_unit_move_avoiding(walkSpeed,0,0);  
                }
            }
        }
        //Starts the worker to building
        if (workStart){
            image_speed = miningImageSpeed;
            if (!drawTool){
                workTimer ++;
                //set the sprite
                sprite_index = spriteBuilding;
                if (x &gt; target.x){
                    image_xscale = -1;
                }else{
                    image_xscale = 1;
                } 
                //Triggers sound and particles
                if (round(image_index) == 5 &amp;&amp; cutSound == 0){
                    var sound = audio_play_sound_at(pickSound[workRRPosition],x,y,0,1000,200,1,0,999999);  
                    audio_sound_gain(sound,global.sfxVol,0);
                    workRRPosition ++;
                    if (workRRPosition &gt; 3){
                        randomize();
                        workRRPosition = irandom(2);
                    }
                    cutSound = 1; 
                } 
                if (round(image_index) != 5){
                    cutSound = 0;
                }
                //Makes miner take the resources to the stockpile
                if (workTimer &gt;= workTime){
                    randomize();
                    goingTo = 0;
                    gettingResources = 1;
                    workStart = 0;
                    workTimer = 0;
                    moveToTime = 2 + irandom(20);
                    moveToTimer = 0;
                    middleTimer = 0;
                    workTime = (baseWorkTime + workTimeAdd);
                    //pops up xp gained
                    var targetXp = string(target.xp);
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        amount = ("+" + targetXp + "XP");
                        col = c_yellow;
                        myWorker = other.id;
                    }
                    //Take away the resources the worker was building with
                    for (i = 0; i &lt; 3; i++){
                        if (target.cost[i,0] == currentResource){
                            target.cost[i,2] -= 40;
                            target.amountBuilt += 40;
                            for (a = 0; a &lt;= 10; a++;){
                                if (inv[a,0] == currentResource){
                                    inv[a,0] = -1;
                                    inv[a,1] = -1;
                                    inv[a,2] = -1;
                                    break;
                                }
                            }
                            currentResource = -1;
                            break;
                        }   
                    }
                    
                    if (xpMining &gt;= xpNeededMining){
                        //miningLevel ++;
                        //xpNeededMining += floor(miningLevel+300 * power(2,(miningLevel/7)));
                        //baseMiningTime -= (10 + irandom(5));
                    }
                    
                }
            }else{
            //starts the pulling out tool animation
                sprite_index = spriteBuildingDrawTool;
                if (target.x &gt; x){
                    image_xscale = 1;    
                }else{
                    image_xscale = -1;    
                }
                    drawToolTimer ++;
                if (drawToolTimer &gt;= drawToolTimeWoodcutting){
                    drawTool = 0;
                    drawToolTimer = 0;
                    dir = point_direction(x,y,target.x,target.y);
                }
            }
        }
        if (target.built){
            if (target.object_index = obj_lift){
                (target.myElevator).y = target.y + 10;
            }
            middleTimer = 0;
            goingTo = 0;
            gettingResources = 0;
            state = 'idle';
            if (x &gt; target.x){
                image_xscale = -1;
            }else{
                image_xscale = 1;  
            }
        }            
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Upgrading

if (!dying){
    
    if (state == 'upgrading'){
        if (!gettingResources){
            moveToTimer ++;
            image_speed = walkingImageSpeed;
            //Workers walks to the building to bulid it
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalkingResources;
                if (target.x &gt; x &amp;&amp; !workStart &amp;&amp; goingTo){
                    image_xscale = 1;
                    scr_unit_move_avoiding(walkSpeed,0,1);  
                }else if(!workStart &amp;&amp; goingTo){
                    image_xscale = -1;
                    scr_unit_move_avoiding(walkSpeed,0,0); 
                }
            }
        }else{
            moveToTimer ++;
            image_speed = walkingImageSpeed;
            //Worker goes to get resources from the stockpile to build the building with
            if (moveToTimer &gt; moveToTime){
                sprite_index = spriteWalking;
                if (obj_warehouse.x &gt; x &amp;&amp; !workStart &amp;&amp; gettingResources){
                    image_xscale = 1;
                    scr_unit_move_avoiding(walkSpeed,0,1);  
                }else if(!workStart &amp;&amp; gettingResources){
                    image_xscale = -1;
                    scr_unit_move_avoiding(walkSpeed,0,0);  
                }
            }
        }
        //Starts the worker to building
        if (workStart){
            image_speed = miningImageSpeed;
            if (!drawTool){
                workTimer ++;
                //set the sprite
                sprite_index = spriteBuilding;
                if (x &gt; target.x){
                    image_xscale = -1;
                }else{                    
                    image_xscale = 1;
                } 
                //Triggers sound and particles
                if (round(image_index) == 5 &amp;&amp; cutSound == 0){
                    var sound = audio_play_sound_at(pickSound[workRRPosition],x,y,0,1000,200,1,0,999999);  
                    audio_sound_gain(sound,global.sfxVol,0);
                    workRRPosition ++;
                    if (workRRPosition &gt; 3){
                        randomize();
                        workRRPosition = irandom(2);
                    }
                    cutSound = 1; 
                } 
                if (round(image_index) != 5){
                    cutSound = 0;
                }
                //Makes worker take the resources to the stockpile
                if (workTimer &gt;= workTime){
                    randomize();
                    goingTo = 0;
                    gettingResources = 1;
                    workStart = 0;
                    workTimer = 0;
                    moveToTime = 2 + irandom(20);
                    moveToTimer = 0;
                    middleTimer = 0;
                    workTime = (baseWorkTime + workTimeAdd);
                    //pops up xp gained
                    var targetXp = string(target.xp);
                    with(instance_create(x,y,obj_workerDrawTimed)){
                        amount = ("+" + targetXp + "XP");
                        col = c_yellow;
                        myWorker = other.id;
                    }
                    //Take away the resources the worker was building with
                    for (i = 0; i &lt; 3; i++){
                        if (target.upgradeCost[i,0] == currentResource){
                            target.upgradeCost[i,2] -= 40;
                            target.amountUpgraded += 40;
                            for (a = 0; a &lt;= 10; a++;){
                                if (inv[a,0] == currentResource){
                                    inv[a,0] = -1;
                                    inv[a,1] = -1;
                                    inv[a,2] = -1;
                                    break;
                                }
                            }
                            currentResource = -1;
                            break;
                        }   
                    }
                    
                }
            }else{
            //starts the pulling out tool animation
                sprite_index = spriteBuildingDrawTool;
                if (target.x &gt; x){
                    image_xscale = 1;    
                }else{
                    image_xscale = -1;    
                }
                    drawToolTimer ++;
                if (drawToolTimer &gt;= drawToolTimeWoodcutting){
                    drawTool = 0;
                    drawToolTimer = 0;
                    dir = point_direction(x,y,target.x,target.y);
                }
            }
        } 
        if (target.upgrade == 0){
            middleTimer = 0;
            goingTo = 0;
            gettingResources = 0;
            state = 'idle';
            sprite_index = spriteIdle;
            if (x &gt; target.x){
                image_xscale = -1;
            }else{
                image_xscale = 1;    
            }
        }         
    }  
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Stamina regen

if (!run &amp;&amp; stamina &lt; maxStamina){
    staminaTimer ++;
    if (staminaTimer &gt;= 180){
        staminaRegen = 1;
        stamina ++;
    }
}

if (staminaRegen &amp;&amp; stamina == maxStamina){
    staminaRegen = 0;    
    staminaTimer ++;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_warehouse">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Give resources/pick up resources

//Starts middletimer/changes dropoff var
if (comingFrom){
    middleTimer ++;
    if (middleTimer == 60){
        supplyDropOff = 1;
        dropX = x;
        dropY = y;
        image_index = 0;
    }
}

// Adds the resources and sets the worker back to working
if (other.object_index = dropOffTarget &amp;&amp; middleTimer &gt;= 60 &amp;&amp; !gettingResources){
    if ((state == 'mining' || state == 'woodcutting' || state == 'farming') &amp;&amp; comingFrom){
        
        if (!supplyDropOff){
            //loop through the inv slots and add any resources found to the warehouse
            for (i = 3; i&lt;=6; i++;){
                if ( (is_real(inv[i,0]) &amp;&amp; inv[i,0] != -1) || (is_string(inv[i,1]) &amp;&amp; (inv[i,1] == 'resource' || inv[i,1] == 'gem')) ){
                    var yy = 0;
                    (instance_create(x,y+yy,obj_workerDrawTimed)).amount = ("+" + string(inv[i,6]) + " " + string(inv[i,0])); 
                    yy += 32;
                    switch(inv[i,0]){
                        case 'stone': 
                            global.stone += inv[i,6]; 
                            global.totalResourcesCollected += inv[i,6];  
                        break;
                        
                        case 'woodCommon': 
                            global.woodCommon += inv[i,6] 
                            global.totalResourcesCollected += inv[i,6];
                        break;
                
                        case 'food': 
                            global.food += inv[i,6]; 
                            global.totalResourcesCollected += inv[i,6];
                        break;  
                        
                        case 'gold': 
                            global.gold += inv[i,6]; 
                            global.totalResourcesCollected += inv[i,6];
                        break;
                    }
                    //clear the slot
                    inv[i,0] = -1;
                    inv[i,1] = -1;
                    inv[i,2] = -1;
                    inv[i,3] = -1;
                    inv[i,4] = -1;
                    inv[i,5] = -1;
                    inv[i,6] = -1;
                }else{
                    break;
                }
            }
            //set the worker going back
            comingFrom = 0;
            goingTo = 1;
            middleTimer = 0;
        }else{
            //Chnage to the proper sprite
            x = dropX;
            y = dropY;
            image_speed = .10;
            sprite_index = spriteDropResources;   
            
            if (image_index &gt;= 6){
                supplyDropOff = 0;
            }
            
        }
        
        
    }
}
//Get resources to bulid with
if (gettingResources){
    middleTimer ++;
    if (middleTimer &gt;= 55){
        slot = scr_unit_find_inventory_slot();
        //Give the worker the right resources
        if (target.built != 1){
            if (scr_building_find_resource_needed() != -4){
                var resource = scr_building_find_resource_needed();
                switch(target.cost[resource,0]){
                    case 'woodCommon':
                        if (global.woodCommon &gt;= 40){
                            global.woodCommon -= 40;
                            gettingResources = 0;
                            currentResource = 'woodCommon';
                            goingTo = 1;
                            middleTimer = 0;
                            moveToTimer = 0;
                            inv[slot,0] = 'woodCommon';
                            inv[slot,1] = 'resource';
                            inv[slot,2] = 40;
                        }
                    break;    
                
                }
      
            }else{
                state = "idle";
                goingTo = 0;
                middleTimer = 0;
                moveToTimer = 0;
                gettingResources = 0;
            }   
        }
    }
    
}









</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Upgrading 

//Get resources to bulid with
if (gettingResources){
    middleTimer ++;
    if (middleTimer &gt;= 55){
        slot = scr_unit_find_inventory_slot();
        //Give the worker the right resources
        if (target.upgrade == 1){
            if (scr_building_find_resource_needed_upgrade(target) != -4){
                var resource = scr_building_find_resource_needed_upgrade(target);
                //Put the proper resource into the worker's inventory
                switch(target.upgradeCost[resource,0]){
                    //Wood
                    case 'woodCommon':
                        if (global.woodCommon &gt;= 40){
                            global.woodCommon -= 40;
                            gettingResources = 0;
                            currentResource = 'woodCommon';
                            goingTo = 1;
                            middleTimer = 0;
                            moveToTimer = 0;
                            inv[slot,0] = 'woodCommon';
                            inv[slot,1] = 'resource';
                            inv[slot,2] = 40;
                        }
                    break;   
                    //food 
                     case 'food':
                        if (global.food &gt;= 40){
                            global.food -= 40;
                            gettingResources = 0;
                            currentResource = 'food';
                            goingTo = 1;
                            middleTimer = 0;
                            moveToTimer = 0;
                            inv[slot,0] = 'food';
                            inv[slot,1] = 'resource';
                            inv[slot,2] = 40;
                        }
                    break;  
                    //stone 
                    case 'stone':
                        if (global.stone &gt;= 40){
                            global.stone -= 40;
                            gettingResources = 0;
                            currentResource = 'stone';
                            goingTo = 1;
                            middleTimer = 0;
                            moveToTimer = 0;
                            inv[slot,0] = 'stone';
                            inv[slot,1] = 'resource';
                            inv[slot,2] = 40;
                        }
                    break;  
                    
                
                }
      
            }else{
                state = "idle";
                goingTo = 0;
                middleTimer = 0;
                moveToTimer = 0;
                gettingResources = 0;
            }   
        }
    }
    
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_farmingPatch">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Start building 

if (other.id == target &amp;&amp; goingTo){
    if (middleTimer == 0){
        workMiddleTime = (target.midTime + irandom(target.midRandom));
    }
    middleTimer ++;  
     
}

if (state == 'building' &amp;&amp; middleTimer &gt;= workMiddleTime &amp;&amp; resourcePosition == 0 &amp;&amp; !gettingResources &amp;&amp; other.id == target){
    workStart = 1;
    drawTool = 1;
    goingTo = 0;
    image_index = 0;
    moveToTimer = 0;
    comingFrom = 0;
    var workTimeAdd = irandom(round(baseBuildingTime/3)); 
    workTime = (baseBuildingTime + workTimeAdd);
    middleTimer = 0;
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///farming
//Starts the worker farming

if (other.id == target &amp;&amp; goingTo &amp;&amp; !global.workerBuild &amp;&amp; other.built){
    middleTimer ++;
    if (middleTimer == 1){
        middleTime = (target.midTime + irandom(midRandom));
    }
}

if (state == 'farming' &amp;&amp; other.id == target &amp;&amp; goingTo &amp;&amp; middleTimer &gt; middleTime){
    drawTool = 1;
    farmStart = 1; 
    goingTo = 0;
    comingFrom = 0; 
    middleTimer = 0;
    moveToTimer = 0;
    randomize();
    farmTimeAdd = irandom(round(baseFarmingTime/3));
    farmingTime = (baseFarmingTime + cutTimeAdd);
    workingLenDirX = lengthdir_x(40,point_direction(x,y,target.x,target.y));
    workingLenDirY = lengthdir_y(26,point_direction(x,y,target.x,target.y));
    image_index = 0;
}else if (other.exhausted &amp;&amp; state == 'farming' &amp;&amp; !comingFrom){
    waitingToFarm = 1;
    goingTo = 0;
    comingFrom = 0;    
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_buildingParent">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Start building 

if (other.id == target &amp;&amp; goingTo &amp;&amp; state == 'building'){
    if (middleTimer == 0){
        workMiddleTime = (target.midTime + irandom(target.midRandom));
    }
    middleTimer ++;  
     
}

if (state == 'building' &amp;&amp; middleTimer &gt;= workMiddleTime &amp;&amp; resourcePosition == 0 &amp;&amp; !gettingResources &amp;&amp; other.id == target){
    workStart = 1;
    drawTool = 1;
    goingTo = 0;
    image_index = 0;
    moveToTimer = 0;
    comingFrom = 0;
    var workTimeAdd = irandom(round(baseBuildingTime/3)); 
    workTime = (baseBuildingTime + workTimeAdd);
    middleTimer = 0;
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Start upgrading

if (other.id == target &amp;&amp; goingTo &amp;&amp; state == 'upgrading'){
    if (middleTimer == 0){
        workMiddleTime = (target.midTime + irandom(target.midRandom));
    }
    middleTimer ++;  
     
}

if (state == 'upgrading' &amp;&amp; middleTimer &gt;= workMiddleTime &amp;&amp; resourcePosition == 0 &amp;&amp; !gettingResources &amp;&amp; other.id == target){
    workStart = 1;
    drawTool = 1;
    goingTo = 0;
    image_index = 0;
    moveToTimer = 0;
    comingFrom = 0;
    var workTimeAdd = irandom(round(baseBuildingTime/3)); 
    workTime = (baseBuildingTime + workTimeAdd);
    middleTimer = 0;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_treeParent">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Woodcut
//Starts the worker woodcutting
if (state == 'woodcutting'){
    if (instance_exists(target)){
        if (other.id == target &amp;&amp; goingTo){
            middleTimer ++;
        }   
    }
    if (instance_exists(target)){
        if (other.id == target &amp;&amp; goingTo &amp;&amp; (middleTimer &gt;= middleTime) &amp;&amp; woodcuttingLevel &gt;= target.levelReq){
            drawTool = 1;
            cutStart = 1;
            randomize();
            cutTimeAdd = irandom(round(baseCuttingTime/3));
            cuttingTime = (baseCuttingTime + cutTimeAdd);
            moveToTimer = 0;
            image_index = 0; 
            goingTo = 0;
            comingFrom = 0; 
            middleTimer = 0;
            workingLenDirX = lengthdir_x(40,point_direction(x,y,target.x,target.y));
            workingLenDirY = lengthdir_y(26,point_direction(x,y,target.x,target.y));
        }else if (woodcuttingLevel &lt; target.levelReq &amp;&amp; other.id == target.id &amp;&amp; state == 'woodcutting'){
            goingTo = 0;
            middleTimer = 0;
            state = 'idle';
            var msg = instance_create(x,y,obj_workerDrawTimed);
            msg.col = c_red;
            msg.amount = "Can't do that."
            image_speed = idleImageSpeed;
            sprite_index = spriteIdle;
            if (target.x &gt; x){
                image_xscale = 1;
            }else{
                image_yscale = -1;
            }
        }
    }
    if (instance_exists(target)){
        if (other.id == target &amp;&amp; !drawTool &amp;&amp; cutSound){
            other.animationTimer = 0;
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_resourceParent">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///mine
//Starts the worker mining

if (other.id == target &amp;&amp; goingTo){
    middleTimer ++;
}

if (state == 'mining' &amp;&amp; other.id == target &amp;&amp; goingTo &amp;&amp; other.exhausted = 0 &amp;&amp; miningLevel &gt;= other.levelReq &amp;&amp; middleTimer &gt; middleTimeMining &amp;&amp; resourcePosition == 0){
    randomize();
    mineStart = 1;
    drawTool = 1; 
    goingTo = 0;
    image_index = 0;
    moveToTimer = 0;
    comingFrom = 0;
    mineTimeAdd = irandom(round(baseMiningTime/3));
    miningTime = (baseMiningTime + mineTimeAdd);
    middleTimer = 0;
    comingFrom = 0; 
}else if (other.exhausted &amp;&amp; state == 'mining'){
    waitingToMine = 1;
    goingTo = 0;
    comingFrom = 0;    
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_tileSurfaceFlatParent">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Put the worker at the right y pos, when they are on flat ground


if (y != other.y-24){
    if (!place_meeting(x,y,obj_tileSurfaceHillParent)){
        y = (other.y-24);
    }
}
    

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_enemyParent">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///being attacked
beingAttacked = 1;
knockBack = 1;
attacker = other.id;

//minerTimer = 1;
numberTimer = 1;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///dev mode

//show debug info
if (showDebug){
    showDebug = 0;
}else{
    showDebug = 1;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///select

event_inherited();

if (!global.workerBuild &amp;&amp; !global.dev_mode_dupe &amp;&amp; !global.shiftSelect &amp;&amp; global.multiClickSelect &lt; 2){
    //clear unit array
    scr_unit_array_clear();
    global.unitSelected[0] = id;
    selected = 1;
    global.selectedNumber = 1;
    (obj_globalCon.buildButton).visible = 1;
}
if (global.shiftSelect){
    scr_unit_array_add(id);
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///General
draw_self();
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Hp/stamina bar

//If the worker is running , draw the stamina bar
if (run || staminaRegen){
    draw_rectangle_colour(x-6,y-38,x+16,y-42,c_black,c_black,c_black,c_black,0);
    var stPercent = ((stamina/maxStamina)*10)*10;
    var drawPercent = round( ((stPercent/100) * 20) ); 
    draw_rectangle_colour(x-6,y-38,(x-6)+drawPercent,y-42,c_green,c_green,c_green,c_green,0);
} 


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>11,19</point>
    <point>16,16</point>
  </PhysicsShapePoints>
</object>
